<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>할일</h2>
    <form class="nameForm">
        <h2 class="nameTitle"></h2>
        <input type="text" placeholder="이름을 입력해 주세요">
        <button type="button">확인</button>
    </form>

    <form class="todoForm">
        <input type="text" placeholder="할일을 적으세요">
        <button type="button">확인</button>
    </form>

    <ul class="tolist">

    </ul>

    <script>
        // ＊ 이름 
        var nameForm = document.querySelector(".nameForm");
        var nameInput = nameForm.querySelector("input");
        var nameButton = nameForm.querySelector("button");
        var nameTitle = nameForm.querySelector("h2");

        nameButton.addEventListener("click", regist);

        function regist() {
            nameTitle.innerHTML = nameInput.value + "님 안녕하세요"
            nameButton.style.display = "none"; // button 안보이도록
            nameInput.style.display = "none"; // input 안보이도록     
        };

        var todoForm = document.querySelector(".todoForm");
        var todoInput = todoForm.querySelector("input");
        var todoButton = todoForm.querySelector("button");

        // ＊ 할일
        todoButton.addEventListener("click", handleTodo);
        function handleTodo() {
            createTodo(todoInput.value); // 엘리먼트값
            todoInput.value = ""; // input 초기화
        };

        function createTodo(text) {
            var ul = document.querySelector(".tolist");
            // 삭제 버튼생성
            var btn = document.createElement("button");
            btn.innerHTML = "X";
            btn.addEventListener("click", deleteTodo) // 이벤트 추가
            // 이동버튼
            var btn2 = document.createElement("button");
            btn2.innerHTML = "↑";
            btn2.addEventListener("click", up)
            // 이동버튼
            var btn3 = document.createElement("button");
            btn3.innerHTML = "↓";
            btn3.addEventListener("click", down);

            // li생성
            var li = document.createElement("li")
            li.innerHTML = text;
            // li에 버튼추가
            li.appendChild(btn);
            li.appendChild(btn2);
            li.appendChild(btn3);
            // ul에 li 추가
            ul.appendChild(li);
        };

        function deleteTodo() {
            this.parentElement.remove(); // this를 사용한것의 부모를 삭제
        };


        function up() {
            var tolist = document.querySelector(".tolist")
            var current = this.parentElement; // li들끼리 자리 이동
            var prev = current.previousElementSibling;
            var bool;
            console.log(tolist)
            if (prev == null) {
                alert("더이상 올라갈곳이 없어요~");
                return;
            } else {
                bool = confirm("위로 올라가시겠습니까??")
                if (bool) {
                    tolist.insertBefore(current, prev);
                }
            }

        }

        function down() {
            var tolist = document.querySelector(".tolist")

            var current = this.parentElement;
            var next = current.nextElementSibling;

            console.log(current, next)
            if(next === null) return;
            if(confirm("이동하시겠습니까?")) {
                tolist.insertBefore(next, current);
            }
        }



    </script>

</body>

</html>